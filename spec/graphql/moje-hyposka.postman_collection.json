{"collection":{"info":{"_postman_id":"f601b924-d250-4fa6-85b1-c2759d0d5c3d","name":"moje-hyposka","description":"This top level folder\n- contains collection variables\n- tests 200 return code of all requests (GraphQL API should always return 200)","schema":"https://schema.getpostman.com/json/collection/v2.1.0/collection.json"},"item":[{"name":"signup","item":[{"name":"Auth0 password login","event":[{"listen":"test","script":{"id":"88790b01-b91e-44df-95ac-19610957d0fb","exec":["const { access_token } = pm.response.json();","","pm.test(\"response has access token\", function () {","    pm.expect(access_token).to.be.a('string')","});","","pm.environment.set(\"userAccessToken\", access_token);"],"type":"text/javascript"}}],"_postman_id":"c0b5b16a-b58e-485a-84b7-88d71361e32f","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"method":"POST","header":[],"body":{"mode":"urlencoded","urlencoded":[{"key":"grant_type","value":"password","type":"text"},{"key":"client_id","value":"Bw6rF3FlcPaFqa3ZIkuNzrSWFomhMX6Y","type":"text"},{"key":"client_secret","value":"OtDiEJSNB44sXfjy18Uwo57qsHU_93yhG9sNvO2ap9hJX4g7QhE3vJgQ0WG35ubc","description":"Required for confidential clients.","type":"text"},{"key":"audience","value":"https://staging-api.mojehyposka.cz","type":"text"},{"key":"username","value":"tomas.landovsky@gmail.com","type":"text"},{"key":"password","value":"Heslo123456","type":"text"},{"key":"scope","value":"openid profile email","type":"text"}]},"url":{"raw":"https://{{auth0_domain}}/oauth/token","protocol":"https","host":["{{auth0_domain}}"],"path":["oauth","token"]}},"response":[]},{"name":"registerUser email / password","event":[{"listen":"test","script":{"id":"129f1e11-f83e-4de2-aaa3-0ede12e4e6d6","exec":["pm.test(\"response has correct content\", function () {","    pm.expect(pm.response.json().data.loginOrRegisterUser.name).to.eq('tomas.landovsky@gmail.com');","    pm.expect(pm.response.json().data.loginOrRegisterUser.email).to.eq('tomas.landovsky@gmail.com');","    pm.expect(pm.response.json().data.loginOrRegisterUser.emailConfirmed).to.eq(false);","    pm.expect(pm.response.json().data.loginOrRegisterUser.phoneConfirmed).to.eq(false);","});"],"type":"text/javascript"}},{"listen":"prerequest","script":{"id":"ad5d8fdb-0020-4153-b162-3834059c59b6","exec":[""],"type":"text/javascript"}}],"_postman_id":"8d63feb3-a70f-49d1-8c6f-563858cd400b","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"auth":{"type":"noauth"},"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"mutation RegisterUserFacebookPhone($token: String!) {\n    loginOrRegisterUser(accessToken: $token) {\n        email\n        emailConfirmed\n        name\n        phone\n        phoneNumber\n        phoneCountryCode\n        phoneConfirmed\n    }\n}","variables":"{\n\t\"token\": \"{{userAccessToken}}\"\n}"}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]}},"response":[]},{"name":"loginUser","event":[{"listen":"test","script":{"id":"129f1e11-f83e-4de2-aaa3-0ede12e4e6d6","exec":["pm.test(\"response has correct content\", function () {","    pm.expect(pm.response.json().data.loginOrRegisterUser.name).to.eq('tomas.landovsky@gmail.com');","    pm.expect(pm.response.json().data.loginOrRegisterUser.email).to.eq('tomas.landovsky@gmail.com');","    pm.expect(pm.response.json().data.loginOrRegisterUser.emailConfirmed).to.eq(false);","    pm.expect(pm.response.json().data.loginOrRegisterUser.phoneConfirmed).to.eq(false);","});"],"type":"text/javascript"}},{"listen":"prerequest","script":{"id":"ad5d8fdb-0020-4153-b162-3834059c59b6","exec":[""],"type":"text/javascript"}}],"_postman_id":"d81f0f99-1603-468e-8d27-728eb34b42e7","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"auth":{"type":"noauth"},"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"mutation LoginUserFacebookPhone($token: String!) {\n    loginOrRegisterUser(accessToken: $token) {\n        email\n        emailConfirmed\n        name\n        phone\n        phoneNumber\n        phoneCountryCode\n        phoneConfirmed\n    }\n}","variables":"{\n\t\"token\": \"{{userAccessToken}}\"\n}"}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]}},"response":[]}],"_postman_id":"06496e42-9560-4f7b-81f2-f6f5178d0793","description":"Sign-up and login related requests.","event":[{"listen":"prerequest","script":{"id":"d3b1d718-8abf-42e5-bade-29cf722360f7","type":"text/javascript","exec":[""]}},{"listen":"test","script":{"id":"2452c800-aa43-4537-aef3-06fe415da161","type":"text/javascript","exec":["pm.test(\"response should not have errors\", function () { ","    pm.response.to.not.have.jsonBody(\"errors\"); ","});"]}}]},{"name":"product","item":[{"name":"products","event":[{"listen":"test","script":{"id":"ba6d50a3-8194-4b07-a7eb-f10af2fb1715","exec":["pm.test(\"response contains records\", function () {","    pm.expect(pm.response.json().data.products.length).to.be.above(0);","});"],"type":"text/javascript"}}],"_postman_id":"7d2fb90d-f2c4-49fb-90e5-4df9d3d482df","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"auth":{"type":"noauth"},"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"query productSearch($loanSize: Int!, $maturity: Int!, $fixation: Int,\n                    $filterIds: [Int!], $ltv: Float!, $purposeId: Int!) {  \n  products(loanSize: $loanSize, maturity: $maturity,\n           fixation: $fixation, filterIds: $filterIds,\n           ltv: $ltv, purposeId: $purposeId) {\n    id\n    name\n    bankName\n    rate\n    unlisted\n  }\n}\n","variables":"{\n  \"loanSize\": 4000000,\n  \"maturity\": 27,\n  \"fixation\": null,\n  \"filterIds\": [1],\n  \"ltv\": 80,\n  \"purposeId\": 1\n}"}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]}},"response":[{"id":"c46fbb69-3e35-4216-915c-854bf7eecb44","name":"products","originalRequest":{"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"query productSearch($loanSize: Int!, $maturity: Int!, $fixation: Int,\n                    $filterIds: [Int!], $ltv: Float!, $purposeId: Int!) {  \n  products(loanSize: $loanSize, maturity: $maturity,\n           fixation: $fixation, filterIds: $filterIds,\n           ltv: $ltv, purposeId: $purposeId) {\n    id\n    name\n    bankName\n    rate\n    unlisted\n  }\n}\n","variables":"{\n  \"loanSize\": 4000000,\n  \"maturity\": 27,\n  \"fixation\": null,\n  \"filterIds\": [1],\n  \"ltv\": 80,\n  \"purposeId\": 1\n}"}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]}},"status":"OK","code":200,"_postman_previewlanguage":"json","header":[{"key":"X-Frame-Options","value":"SAMEORIGIN"},{"key":"X-XSS-Protection","value":"1; mode=block"},{"key":"X-Content-Type-Options","value":"nosniff"},{"key":"X-Download-Options","value":"noopen"},{"key":"X-Permitted-Cross-Domain-Policies","value":"none"},{"key":"Referrer-Policy","value":"strict-origin-when-cross-origin"},{"key":"Access-Control-Allow-Origin","value":"*"},{"key":"Access-Control-Allow-Methods","value":"POST"},{"key":"Access-Control-Allow-Headers","value":"Origin, Content-Type, Accept, Authorization, Token, Auth-Token, Email, X-User-Token, X-User-Email"},{"key":"Access-Control-Max-Age","value":"1728000"},{"key":"Content-Type","value":"application/json; charset=utf-8"},{"key":"ETag","value":"W/\"7e5be45420f6e02335317bd44b9abd6b\""},{"key":"Cache-Control","value":"max-age=0, private, must-revalidate"},{"key":"X-Request-Id","value":"0aa54e31-8b8b-428f-856b-81ac80c78995"},{"key":"X-Runtime","value":"0.011954"},{"key":"Transfer-Encoding","value":"chunked"}],"cookie":[],"responseTime":null,"body":"{\n    \"data\": {\n        \"products\": [\n            {\n                \"id\": \"1-1\",\n                \"name\": \"Hypotéka na družstevní byt\",\n                \"bankName\": \"Moje Banka\",\n                \"rate\": 2,\n                \"unlisted\": true\n            },\n            {\n                \"id\": \"1-1\",\n                \"name\": \"Hypotéka na družstevní byt\",\n                \"bankName\": \"Moje Banka\",\n                \"rate\": 2.3,\n                \"unlisted\": false\n            },\n            {\n                \"id\": \"1-2\",\n                \"name\": \"Hypotéka na družstevní byt\",\n                \"bankName\": \"Moje Banka\",\n                \"rate\": 2.5,\n                \"unlisted\": true\n            },\n            {\n                \"id\": \"1-3\",\n                \"name\": \"Hypotéka na družstevní byt\",\n                \"bankName\": \"Moje Banka\",\n                \"rate\": 2.7,\n                \"unlisted\": true\n            },\n            {\n                \"id\": \"1-2\",\n                \"name\": \"Hypotéka na družstevní byt\",\n                \"bankName\": \"Moje Banka\",\n                \"rate\": 2.8,\n                \"unlisted\": false\n            },\n            {\n                \"id\": \"1-5\",\n                \"name\": \"Hypotéka na družstevní byt\",\n                \"bankName\": \"Moje Banka\",\n                \"rate\": 2.8,\n                \"unlisted\": true\n            },\n            {\n                \"id\": \"1-3\",\n                \"name\": \"Hypotéka na družstevní byt\",\n                \"bankName\": \"Moje Banka\",\n                \"rate\": 3,\n                \"unlisted\": false\n            },\n            {\n                \"id\": \"1-8\",\n                \"name\": \"Hypotéka na družstevní byt\",\n                \"bankName\": \"Moje Banka\",\n                \"rate\": 3,\n                \"unlisted\": true\n            },\n            {\n                \"id\": \"1-5\",\n                \"name\": \"Hypotéka na družstevní byt\",\n                \"bankName\": \"Moje Banka\",\n                \"rate\": 3.1,\n                \"unlisted\": false\n            },\n            {\n                \"id\": \"1-10\",\n                \"name\": \"Hypotéka na družstevní byt\",\n                \"bankName\": \"Moje Banka\",\n                \"rate\": 3.2,\n                \"unlisted\": true\n            },\n            {\n                \"id\": \"1-8\",\n                \"name\": \"Hypotéka na družstevní byt\",\n                \"bankName\": \"Moje Banka\",\n                \"rate\": 3.3,\n                \"unlisted\": false\n            },\n            {\n                \"id\": \"1-10\",\n                \"name\": \"Hypotéka na družstevní byt\",\n                \"bankName\": \"Moje Banka\",\n                \"rate\": 3.5,\n                \"unlisted\": false\n            }\n        ]\n    }\n}"}]},{"name":"products with savings (repaymentsLeft)","event":[{"listen":"test","script":{"id":"ba6d50a3-8194-4b07-a7eb-f10af2fb1715","exec":["pm.test(\"response contains records\", function () {","    pm.expect(pm.response.json().data.products.length).to.be.above(0);","});","","pm.test(\"savings calculation is based on correct assumptions\", function () {","    // This test fails on expected 1.9999999999999998 to equal 2, cannot reproduce","    // pm.expect(pm.response.json().data.products[0].rate).to.eq(2);","    pm.expect(pm.response.json().data.products[0].repayment).to.eq(6556);","    pm.expect(pm.response.json().data.products[0].repaymentModel).to.eq('30/360');","});","","pm.test(\"response contains savings calculation\", function () {","    pm.expect(pm.response.json().data.products[0].savings).to.eq(45500);","});"],"type":"text/javascript"}}],"_postman_id":"f873b904-de7e-4db4-a120-8ea6eeb72543","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"auth":{"type":"noauth"},"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"query productSearch($loanSize: Int!, $maturity: Int!, $fixation: Int,\n                    $filterIds: [Int!], $ltv: Float!, $purposeId: Int!, $loan: ExistingLoanAttributes) {  \n  products(loanSize: $loanSize, maturity: $maturity,\n           fixation: $fixation, filterIds: $filterIds,\n           ltv: $ltv, purposeId: $purposeId) {\n    id\n    name\n    bankName\n    rate\n    unlisted\n    repayment\n    repaymentModel\n    savings(existingLoanAttributes: $loan)\n  }\n}\n","variables":"{\n  \"loanSize\": 765660,\n  \"maturity\": 130,\n  \"fixation\": null,\n  \"ltv\": 50,\n  \"purposeId\": 1,\n  \"loan\": {\n  \t\"loanSize\": 765660,\n  \t\"rate\": 3,\n  \t\"repaymentsLeft\": 130\n  }\n}"}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]},"description":"Savings calculated with submitted number of repayments left in current mortgage."},"response":[]},{"name":"products with savings (end of loan)","event":[{"listen":"test","script":{"id":"ba6d50a3-8194-4b07-a7eb-f10af2fb1715","exec":["pm.test(\"response contains records\", function () {","    pm.expect(pm.response.json().data.products.length).to.be.above(0);","});","","pm.test(\"savings calculation is based on correct assumptions\", function () {","    pm.expect(pm.response.json().data.products[0].id).to.eq('1-3');","    pm.expect(pm.response.json().data.products[0].repaymentModel).to.eq('30/360');","    pm.expect(pm.response.json().data.products[0].rate).to.eq(2.7);","    pm.expect(pm.response.json().data.products[0].repayment).to.eq(6812);","});","","pm.test(\"response contains savings calculation\", function () {","    // Temporarily disabled","    // pm.expect(pm.response.json().data.products[0].savings).to.eq(18460);","});"],"type":"text/javascript"}}],"_postman_id":"77b56d49-7fb9-4a62-a351-914c654fd951","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"auth":{"type":"noauth"},"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"query productSearch($loanSize: Int!, $maturity: Int!, $fixation: Int,\n                    $filterIds: [Int!], $ltv: Float!, $purposeId: Int!, $loan: ExistingLoanAttributes) {  \n  products(loanSize: $loanSize, maturity: $maturity,\n           fixation: $fixation, filterIds: $filterIds,\n           ltv: $ltv, purposeId: $purposeId) {\n    id\n    name\n    bankName\n    rate\n    unlisted\n    repayment\n    repaymentModel\n    savings(existingLoanAttributes: $loan)\n  }\n}\n","variables":"{\n  \"loanSize\": 767045,\n  \"maturity\": 130,\n  \"fixation\": 3,\n  \"ltv\": 80,\n  \"purposeId\": 1,\n  \"loan\": {\n  \t\"rate\": 3.1,\n  \t\"loanSize\": 767045,\n  \t\"maturityMonth\": 8,\n  \t\"maturityYear\": 2030\n  }\n}"}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]},"description":"Savings calculated with submitted end of maturity (maturityMonth + maturityYear) of current mortgage."},"response":[]},{"name":"products with savings (validation errors)","event":[{"listen":"test","script":{"id":"ba6d50a3-8194-4b07-a7eb-f10af2fb1715","exec":["pm.test(\"response has correct error code, message and backtrace\", function () {","    pm.expect(pm.response.json().errors[0].code).to.eq('validation_failed');","    pm.expect(pm.response.json().errors[0].error.validationFailed.message).to.eq('current_repayments_left: or (maturity_month: and maturity_year:) must be present, current_rate or current_repayment must be present');","});"],"type":"text/javascript"}}],"_postman_id":"005c9517-a19b-4f2c-8971-28ccd81e3e06","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"auth":{"type":"noauth"},"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"query productSearch($loanSize: Int!, $maturity: Int!, $fixation: Int,\n                    $filterIds: [Int!], $ltv: Float!, $purposeId: Int!, $loan: ExistingLoanAttributes) {  \n  products(loanSize: $loanSize, maturity: $maturity,\n           fixation: $fixation, filterIds: $filterIds,\n           ltv: $ltv, purposeId: $purposeId) {\n    id\n    name\n    bankName\n    rate\n    unlisted\n    repayment\n    savings(existingLoanAttributes: $loan)\n  }\n}\n","variables":"{\n  \"loanSize\": 765660,\n  \"maturity\": 130,\n  \"fixation\": null,\n  \"ltv\": 50,\n  \"purposeId\": 1,\n  \"loan\": {\n  \t\"loanSize\": 765660\n  }\n}"}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]},"description":"Validation errors raised by backend when attributes are missing."},"response":[]},{"name":"product - listed","event":[{"listen":"test","script":{"id":"129f1e11-f83e-4de2-aaa3-0ede12e4e6d6","exec":["pm.test(\"response product is an object\", function () {","    pm.expect(pm.response.json().data.product).to.be.an('object');","});","pm.test(\"response product is unlisted with correct rate\", function () {","    pm.expect(pm.response.json().data.product.rate).to.eq(2.3);","    pm.expect(pm.response.json().data.product.unlisted).to.eq(false);","});"],"type":"text/javascript"}}],"_postman_id":"09a284cc-0215-4b43-aa80-b51f7402e480","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"auth":{"type":"noauth"},"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"{\n  product(id: \"1-1\") {\n    rate\n    id\n    name\n    bankName\n    bankId\n    label\n    purposes\n    ltvMin\n    ltvMax\n    maturityMin\n    maturityMax\n    loanSizeMin\n    loanSizeMax\n    fixation\n    rate\n    unlisted\n    validTo\n    eletronicSubmission\n    daysToApproval\n    repayment(loanSize:1000000, maturity:30)\n    rates { fixation rate }\n    features { name }\n    fees { name mandatory amount }\n    conditions { name }\n    documents { name }\n  }\n}\n","variables":""}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]}},"response":[]},{"name":"product - unlisted","event":[{"listen":"test","script":{"id":"129f1e11-f83e-4de2-aaa3-0ede12e4e6d6","exec":["pm.test(\"response product is an object\", function () {","    pm.expect(pm.response.json().data.product).to.be.an('object');","});","pm.test(\"response product is unlisted with correct rate\", function () {","    pm.expect(pm.response.json().data.product.rate).to.eq(2);","    pm.expect(pm.response.json().data.product.unlisted).to.eq(true);","});"],"type":"text/javascript"}}],"_postman_id":"b3812cb5-148e-4c63-8113-f352e7ee5ea3","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"auth":{"type":"bearer","bearer":[{"key":"token","value":"{{userAccessToken}}","type":"string"}]},"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"{\n  product(id: \"1-1\") {\n    rate\n    id\n    name\n    bankName\n    bankId\n    label\n    purposes\n    ltvMin\n    ltvMax\n    maturityMin\n    maturityMax\n    loanSizeMin\n    loanSizeMax\n    fixation\n    rate\n    unlisted\n    validTo\n    eletronicSubmission\n    daysToApproval\n    repayment(loanSize:1000000, maturity:30)\n    rates { fixation rate }\n    features { name }\n    fees { name mandatory amount }\n    conditions { name }\n    documents { name }\n  }\n}\n","variables":""}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]}},"response":[]}],"_postman_id":"8209e36c-ff3e-4eb6-93b8-3bcf05523b75","event":[{"listen":"prerequest","script":{"id":"67c45fbc-8405-40ea-90d3-4c1fd7f55a28","type":"text/javascript","exec":[""]}},{"listen":"test","script":{"id":"5b167663-a93b-481d-8608-9c0d010f6ddf","type":"text/javascript","exec":["pm.test(\"response should not have errors\", function () { ","    pm.response.to.not.have.jsonBody(\"error\"); ","});"]}}]},{"name":"filters","item":[{"name":"filters","event":[{"listen":"test","script":{"id":"129f1e11-f83e-4de2-aaa3-0ede12e4e6d6","exec":["var filters = pm.response.json().data.filters;","var filter = filters.filter(function(filter) { return filter.name == \"chci družstevní byt\"})[0]","","pm.test(\"response has correct content\", function () {","    pm.expect(filter.name).to.eq('chci družstevní byt');","    pm.expect(filter.group).to.eq('property_type');","    pm.expect(filter.groupTitle).to.eq('typ nemovitosti');","});",""],"type":"text/javascript"}},{"listen":"prerequest","script":{"id":"ad5d8fdb-0020-4153-b162-3834059c59b6","exec":[""],"type":"text/javascript"}}],"_postman_id":"f2746b99-2cfe-4438-88a9-bfdb51c3e17f","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"query listFilters($purposes: [PurposeGroupCategory!], $groups: [FilterGroupCategory!]) {\n  filters(purposes: $purposes, groups: $groups) {\n    id\n    name\n    disabled\n    group\n    groupDefault\n    groupTitle\n  }\n}","variables":"{\n  \"purposes\": [\"PURCHASE\"],\n  \"groups\": []\n}"}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]}},"response":[]}],"_postman_id":"ee203bca-9154-40e5-8355-ceb4e30dcfd3","description":"Query to list filters."},{"name":"user","item":[{"name":"updateUserProfile","event":[{"listen":"test","script":{"id":"129f1e11-f83e-4de2-aaa3-0ede12e4e6d6","exec":["pm.test(\"response has correct content\", function () {","    pm.expect(pm.response.json().data.updateUserProfile.name).to.eq('Jack Lee');","    pm.expect(pm.response.json().data.updateUserProfile.phone).to.eq('+420 622 333 444');","    pm.expect(pm.response.json().data.updateUserProfile.postcode).to.eq('13000');","});","","pm.test(\"email address was not updated because it was already present\", function () {","    pm.expect(pm.response.json().data.updateUserProfile.email).to.eq('tomas.landovsky@gmail.com');","});"],"type":"text/javascript"}},{"listen":"prerequest","script":{"id":"ad5d8fdb-0020-4153-b162-3834059c59b6","exec":[""],"type":"text/javascript"}}],"_postman_id":"831c8da0-1bdb-4bcc-a889-0c558789836d","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"mutation updateUserProfile($attributes: UserAttributes!) {\n    updateUserProfile(attributes: $attributes) {\n        email\n        emailConfirmed\n        name\n        phone\n        phoneNumber\n        phoneCountryCode\n        phoneConfirmed\n        postcode\n    }\n}","variables":"{\n  \"attributes\": {\n  \t\"name\": \"Jack Lee\",\n  \t\"email\": \"thisValueShouldNotBeUsedForUpdate\",\n  \t\"phoneNumber\": \"622 333 444\",\n  \t\"phoneCountryCode\": \"+420\",\n  \t\"postcode\": \"13000\"\n  }\n}"}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]}},"response":[]},{"name":"updateUserProfile - validation failed","event":[{"listen":"test","script":{"id":"129f1e11-f83e-4de2-aaa3-0ede12e4e6d6","exec":["pm.test(\"response has correct error code, message and backtrace\", function () {","    pm.expect(pm.response.json().errors[0].error.phoneNumber.message).to.eq(\"zadejte mobilní číslo ve tvaru '608 123 123'\");","    pm.expect(pm.response.json().errors[0].code).to.eq('validation_failed');","    pm.expect(pm.response.json().errors[0].backtrace).to.be.an('array').that.is.not.empty","});"],"type":"text/javascript"}},{"listen":"prerequest","script":{"id":"ad5d8fdb-0020-4153-b162-3834059c59b6","exec":[""],"type":"text/javascript"}}],"_postman_id":"4d4f9657-2807-4c93-acee-68c2677dcef1","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"mutation updateUserProfile($attributes: UserAttributes!) {\n    updateUserProfile(attributes: $attributes) {\n        email\n        emailConfirmed\n        name\n        phone\n        phoneConfirmed\n    }\n}","variables":"{\n  \"attributes\": {\n  \t\"name\": \"Jack Lee\",\n  \t\"phoneNumber\": \"000\",\n  \t\"phoneCountryCode\": \"+420\",\n  \t\"postcode\": \"14000\"\n  }\n}\n"}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]}},"response":[]},{"name":"updateUserProfile - phone already taken","event":[{"listen":"test","script":{"id":"129f1e11-f83e-4de2-aaa3-0ede12e4e6d6","exec":["pm.test(\"response has correct error code, message and backtrace\", function () {","    pm.expect(pm.response.json().errors[0].error.phoneNumber.message).to.eq('je už registrováno na jiného uživatele');","    pm.expect(pm.response.json().errors[0].code).to.eq('validation_failed');","    pm.expect(pm.response.json().errors[0].backtrace).to.be.an('array').that.is.not.empty","});"],"type":"text/javascript"}},{"listen":"prerequest","script":{"id":"ad5d8fdb-0020-4153-b162-3834059c59b6","exec":[""],"type":"text/javascript"}}],"_postman_id":"f1fe610a-3b18-4954-9a93-e2d7b5517cea","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"mutation updateUserProfile($attributes: UserAttributes!) {\n    updateUserProfile(attributes: $attributes) {\n        email\n        emailConfirmed\n        name\n        phone\n        phoneConfirmed\n    }\n}","variables":"{\n  \"attributes\": {\n  \t\"name\": \"Jack Lee\",\n  \t\"phoneNumber\": \"723456789\",\n  \t\"phoneCountryCode\": \"+420\",\n  \t\"postcode\": \"13000\"\n  }\n}\n"}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]}},"response":[]}],"_postman_id":"7c7d0219-1806-499d-98b0-c2b64f1c89d0","auth":{"type":"bearer","bearer":[{"key":"token","value":"{{userAccessToken}}","type":"string"}]},"event":[{"listen":"prerequest","script":{"id":"5c59ccdf-fa6c-4564-a617-c8c2735b9bf3","type":"text/javascript","exec":[""]}},{"listen":"test","script":{"id":"a43d0a8a-6994-4166-bee8-b0536e321560","type":"text/javascript","exec":[""]}}]},{"name":"phone verification","item":[{"name":"requestVerificationCode","event":[{"listen":"test","script":{"id":"129f1e11-f83e-4de2-aaa3-0ede12e4e6d6","exec":["pm.test(\"response has correct content\", function () {","    pm.expect(pm.response.json().data.requestVerificationCode.validTo).to.be.an('String').that.is.not.null;","    pm.expect(pm.response.json().data.requestVerificationCode.validityInSeconds).to.be.above(0);","    pm.expect(pm.response.json().data.requestVerificationCode.nextCodeAvailableInSeconds).to.be.above(0);","});","","let verificationCode = pm.response.json().data.requestVerificationCode.code;","","pm.environment.set(\"verificationCode\", verificationCode);","postman.setNextRequest('submitVerificationCode');",""],"type":"text/javascript"}},{"listen":"prerequest","script":{"id":"ad5d8fdb-0020-4153-b162-3834059c59b6","exec":[""],"type":"text/javascript"}}],"_postman_id":"0978b9c3-8a85-4023-abf0-0b89293dbe4e","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"mutation requestVerificationCode {\n    requestVerificationCode {\n        validTo\n        validityInSeconds\n        nextCodeAvailableInSeconds\n        code # only available in test environment\n    }\n}","variables":""}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]}},"response":[]},{"name":"submitVerificationCode","event":[{"listen":"test","script":{"id":"129f1e11-f83e-4de2-aaa3-0ede12e4e6d6","exec":["pm.test(\"response matches the authorized user, phone is confirmed\", function () {","    pm.expect(pm.response.json().data.submitVerificationCode.email).to.be.eq(\"tomas.landovsky@gmail.com\")","    pm.expect(pm.response.json().data.submitVerificationCode.phoneConfirmed).to.eq(true)","});"],"type":"text/javascript"}},{"listen":"prerequest","script":{"id":"ad5d8fdb-0020-4153-b162-3834059c59b6","exec":[""],"type":"text/javascript"}}],"_postman_id":"892047f1-37f2-4ec5-abd1-4543cb0bcf39","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"mutation submitVerificationCode($code: String!) {\n    submitVerificationCode(code: $code) {\n        email\n        phoneConfirmed\n    }\n}","variables":"{\n\t\"code\": \"{{verificationCode}}\"\n}"}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]}},"response":[]}],"_postman_id":"3128d491-46fb-4dcf-a394-ab63d1d83cbc","auth":{"type":"bearer","bearer":[{"key":"token","value":"{{userAccessToken}}","type":"string"}]},"event":[{"listen":"prerequest","script":{"id":"4c97f8b7-7e06-4034-b2bd-c972eef15b40","type":"text/javascript","exec":[""]}},{"listen":"test","script":{"id":"fdc388de-abe5-4547-837a-c7e367ce8994","type":"text/javascript","exec":[""]}}]},{"name":"order","item":[{"name":"submitOrder","event":[{"listen":"test","script":{"id":"129f1e11-f83e-4de2-aaa3-0ede12e4e6d6","exec":["pm.test(\"response has correct content\", function () {","    pm.expect(pm.response.json().data.submitOrder.voucher).to.be.a('String').that.is.not.null;","    pm.expect(pm.response.json().data.submitOrder.bank.name).to.eq('Moje Banka');","});","",""],"type":"text/javascript"}},{"listen":"prerequest","script":{"id":"ad5d8fdb-0020-4153-b162-3834059c59b6","exec":[""],"type":"text/javascript"}}],"_postman_id":"cf2087d7-6be9-4a00-925c-09398212455c","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"mutation submitOrder($order: OrderAttributes!) {\n    submitOrder(attributes: $order) {\n      voucher\n      bank { name }\n  }\n}","variables":"{\n  \"order\": {\n    \"productId\": \"1-1\",\n    \"purpose\": \"PURCHASE\",\n    \"subpurpose\": \"PROPERTY_TYPE\",\n    \"subpurposeId\": 1,\n    \"propertyValue\": 50000,\n    \"userSelectedFixation\": false,\n    \"loanSize\": 4500,\n    \"maturity\": 120,\n    \"filterIds\": [1,2,3],\n    \"existingLoanAttributes\": {\n    \t\"loanSize\": 1,\n    \t\"rate\": 3.1,\n    \t\"repaymentsLeft\": 222,\n    \t\"maturityYear\": 2019,\n    \t\"maturityMonth\": 1\n    },\n    \"userFinancialAttributes\": {\n    \t\"netMonthlyIncome\": 111,\n    \t\"liabilitiesTotal\": 2222,\n    \t\"liabilitiesMonthlyRepayment\": 111\n    }\n  }\n}"}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]}},"response":[]},{"name":"submitOrder variant","event":[{"listen":"test","script":{"id":"129f1e11-f83e-4de2-aaa3-0ede12e4e6d6","exec":["pm.test(\"response has correct content\", function () {","    pm.expect(pm.response.json().data.submitOrder.voucher).to.be.a('String').that.is.not.null;","    pm.expect(pm.response.json().data.submitOrder.bank.name).to.eq('Moje Banka');","});","",""],"type":"text/javascript"}},{"listen":"prerequest","script":{"id":"ad5d8fdb-0020-4153-b162-3834059c59b6","exec":[""],"type":"text/javascript"}}],"_postman_id":"2d59adaa-a224-4a7c-8916-0a69136a05ec","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"mutation submitOrder($order: OrderAttributes!) {\n    submitOrder(attributes: $order) {\n      voucher\n      bank { name }\n  }\n}","variables":"{\n  \"order\": {\n    \"productId\": \"1-2\",\n    \"purpose\": \"PURCHASE\",\n    \"subpurpose\": \"PROPERTY_TYPE\",\n    \"subpurposeId\": 1,\n    \"propertyValue\": 50000,\n    \"userSelectedFixation\": true,\n    \"loanSize\": 4500,\n    \"maturity\": 120,\n    \"filterIds\": [1,2,3]\n  }\n}"}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]}},"response":[]}],"_postman_id":"399753af-71ad-46a3-8eb7-025c30b20ffd","auth":{"type":"bearer","bearer":[{"key":"token","value":"{{userAccessToken}}","type":"string"}]},"event":[{"listen":"prerequest","script":{"id":"fd0a7610-1156-4d0d-8c1e-0b76c71b6698","type":"text/javascript","exec":[""]}},{"listen":"test","script":{"id":"652bf428-64c5-4928-9865-6b7370f6f656","type":"text/javascript","exec":[""]}}]},{"name":"errors","item":[{"name":"resource not found","event":[{"listen":"test","script":{"id":"ba6d50a3-8194-4b07-a7eb-f10af2fb1715","exec":["pm.test(\"response has correct error code, message and backtrace\", function () {","    pm.expect(pm.response.json().errors[0].error.resourceNotFound.message).to.eq('Resource not found');","    pm.expect(pm.response.json().errors[0].code).to.eq('resource_not_found');","    pm.expect(pm.response.json().errors[0].backtrace).to.be.an('array').that.is.not.empty","});"],"type":"text/javascript"}}],"_postman_id":"68bc0aae-c000-43ca-af9a-8f8c0e4a0162","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"{\n  product(id: \"a\") {\n    id\n  }\n}\n","variables":""}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]}},"response":[]},{"name":"unauthorized","event":[{"listen":"test","script":{"id":"129f1e11-f83e-4de2-aaa3-0ede12e4e6d6","exec":["pm.test(\"response has error message\", function () {","    pm.expect(pm.response.json().errors[0].code).to.eq('unauthorized');","});",""],"type":"text/javascript"}},{"listen":"prerequest","script":{"id":"ad5d8fdb-0020-4153-b162-3834059c59b6","exec":[""],"type":"text/javascript"}}],"_postman_id":"ffda2f02-80ea-45d6-ba42-cabcd234645b","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"auth":{"type":"noauth"},"method":"POST","header":[{"key":"Content-Type","name":"Content-Type","type":"text","value":"application/json"}],"body":{"mode":"graphql","graphql":{"query":"mutation requestVerificationCode {\n    requestVerificationCode {\n        validTo\n        validityInSeconds\n        nextCodeAvailableInSeconds\n        code # only available in test environment\n    }\n}","variables":""}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]}},"response":[]}],"_postman_id":"930d1184-dea9-4b33-9c78-bbc842e47127","auth":{"type":"bearer","bearer":[{"key":"token","value":"{{userAccessToken}}","type":"string"}]},"event":[{"listen":"prerequest","script":{"id":"e77b1fdd-1125-4bc8-a16c-37d0055f3d7d","type":"text/javascript","exec":[""]}},{"listen":"test","script":{"id":"be962f1e-5bc9-40bd-8a45-6fb2266d5e88","type":"text/javascript","exec":[""]}}]},{"name":"admin endpoints","item":[{"name":"deleteAllUsers","_postman_id":"8db7af54-d418-48b1-9155-ce6b13755b16","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"method":"POST","header":[],"body":{"mode":"graphql","graphql":{"query":"mutation deleteAllUsers {\n    deleteAllUsers\n}","variables":""}},"url":{"raw":"{{host}}/graphql","host":["{{host}}"],"path":["graphql"]}},"response":[]}],"_postman_id":"7f8fbdea-aa59-46f2-b69a-4841f76fc2b4","auth":{"type":"bearer","bearer":[{"key":"token","value":"{{userAccessToken}}","type":"string"}]},"event":[{"listen":"prerequest","script":{"id":"ca864d1d-00b2-41f9-aa80-b55f81873a1d","type":"text/javascript","exec":[""]}},{"listen":"test","script":{"id":"0a9cc865-328a-4de0-9bfb-b8d288806903","type":"text/javascript","exec":[""]}}]}],"event":[{"listen":"prerequest","script":{"id":"6ee49581-260a-4855-a57b-ff0d42dcd5a3","type":"text/javascript","exec":[""]}},{"listen":"test","script":{"id":"65d32bf7-7641-458c-bc9d-8e79103edee1","type":"text/javascript","exec":["pm.test(\"response code is 200\", function () { ","    pm.response.to.have.status(200); ","});"]}}],"variable":[{"id":"324bba10-a05a-4b25-af34-a0e9d3fe40e0","key":"auth0_domain","value":"staging-moje-hyposka.eu.auth0.com","type":"string"}]}}